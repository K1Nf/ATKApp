import{r as s,j as e,c as $,R as q}from"./EventForm-chunk.js";import{S as G}from"./Sidebar-chunk.js";const U=({onFilter:c})=>{const[r,l]=s.useState(!1),[n,i]=s.useState(""),[o,d]=s.useState(""),[j,u]=s.useState(""),[h,p]=s.useState(""),[x,f]=s.useState(!1),[b,v]=s.useState(!1),[S,k]=s.useState(!1),[y,C]=s.useState(!1),[E,N]=s.useState(!1),[w,F]=s.useState(!1),[P,O]=s.useState(""),[z,A]=s.useState([]),[R,T]=s.useState(""),[I,L]=s.useState("");s.useEffect(()=>{fetch("/api/ref/themes").then(t=>t.json()).then(t=>A(t)).catch(t=>console.error("Ошибка загрузки тем:",t))},[]);const B=()=>l(!r),D=()=>{function t(Q){const g=new URLSearchParams;return Object.entries(Q).forEach(([m,a])=>{typeof a=="string"&&a.trim()!==""?g.append(m,a.trim()):typeof a=="number"&&!isNaN(a)?g.append(m,a.toString()):typeof a=="boolean"&&a===!0&&g.append(m,"true")}),g.toString()}const M=t({municipality:o,organization:j,level:h,important:x,peerFormat:b,bestPractice:S,interagency:y,feedback:E,theme:P,financing:w,dateFrom:R,dateTo:I});c&&c(M)};return e.jsxs("div",{className:"control-panel-wrapper",children:[e.jsxs("div",{className:"control-panel",children:[e.jsx("input",{type:"text",placeholder:"Поиск мероприятий...",value:n,onChange:t=>i(t.target.value)}),e.jsx("button",{onClick:()=>window.location.href="/create",children:"Создать мероприятие"}),e.jsx("button",{onClick:B,children:r?"Скрыть фильтры":"Фильтрация"})]}),r&&e.jsxs("div",{className:"filters",children:[e.jsxs("div",{className:"row",children:[e.jsxs("select",{value:o,onChange:t=>d(t.target.value),children:[e.jsx("option",{value:"",children:"Выбор муниципалитета"}),e.jsx("option",{value:"Муниципалитет 1",children:"Муниципалитет 1"}),e.jsx("option",{value:"Муниципалитет 2",children:"Муниципалитет 2"}),e.jsx("option",{value:"Муниципалитет 3",children:"Муниципалитет 3"}),e.jsx("option",{value:"Муниципалитет 4",children:"Муниципалитет 4"}),e.jsx("option",{value:"Муниципалитет 5",children:"Муниципалитет 5"})]}),e.jsxs("select",{value:j,onChange:t=>u(t.target.value),children:[e.jsx("option",{value:"",children:"Выбор организации"}),e.jsx("option",{value:"Организация А",children:"Организация А"}),e.jsx("option",{value:"Организация Б",children:"Организация Б"}),e.jsx("option",{value:"Организация В",children:"Организация В"}),e.jsx("option",{value:"Организация Г",children:"Организация Г"}),e.jsx("option",{value:"Организация Д",children:"Организация Д"})]}),e.jsxs("select",{value:h,onChange:t=>p(t.target.value),children:[e.jsx("option",{value:"",children:"Уровень мероприятия"}),e.jsx("option",{value:"Муниципальный",children:"Муниципальный"}),e.jsx("option",{value:"Региональный",children:"Региональный"}),e.jsx("option",{value:"Всероссийский",children:"Всероссийский"}),e.jsx("option",{value:"Международный",children:"Международный"})]})]}),e.jsxs("select",{value:P,onChange:t=>O(t.target.value),className:"theme-select",children:[e.jsx("option",{value:"",children:"Выбрать тему"}),z.map(t=>e.jsx("option",{value:t.code,title:t.description,children:t.code},t.code))]}),e.jsxs("div",{className:"date-filter",children:[e.jsx("label",{children:"Дата от:"}),e.jsx("input",{type:"date",value:R,onChange:t=>T(t.target.value)})]}),e.jsxs("div",{className:"date-filter",children:[e.jsx("label",{children:"Дата до:"}),e.jsx("input",{type:"date",value:I,onChange:t=>L(t.target.value)})]}),e.jsxs("div",{className:"checkboxes",children:[e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:x,onChange:t=>f(t.target.checked)})," Важное"]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:b,onChange:t=>v(t.target.checked)})," Формат равный равному"]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:S,onChange:t=>k(t.target.checked)})," Лучшие практики"]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:y,onChange:t=>C(t.target.checked)})," Межведомственное взаимодействие"]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:E,onChange:t=>N(t.target.checked)})," Обратная связь"]}),e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:w,onChange:t=>F(t.target.checked)})," Есть финансирование"]})]}),e.jsx("button",{className:"filter-submit",onClick:D,children:"Фильтровать"}),e.jsx("button",{type:"button",className:"filter-reset",onClick:()=>{i(""),d(""),u(""),p(""),O(""),f(!1),v(!1),k(!1),C(!1),N(!1),F(!1),T(""),L("")},children:"Сбросить фильтры"})]})]})};function _({data:c,error:r,loading:l}){return!c||c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",children:"Нет данных для отображения"})}):l?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",children:"Загрузка данных c сервера..."})}):r?e.jsx("tr",{children:e.jsxs("td",{colSpan:"10",children:["Ошибка: ",r]})}):e.jsx(e.Fragment,{children:c.map(n=>{var i;return e.jsxs("tr",{children:[e.jsx("td",{children:n.themeCode??"—"}),e.jsx("td",{children:n.name??"—"}),e.jsx("td",{children:n.content??"—"}),e.jsx("td",{children:n.date??"—"}),e.jsx("td",{children:n.participantsCount??0}),e.jsx("td",{children:((i=n.links)==null?void 0:i.length)>0?n.links.map((o,d)=>e.jsx("div",{children:e.jsx("a",{href:o,target:"_blank",rel:"noopener noreferrer",children:o})},d)):"—"}),e.jsx("td",{children:e.jsx("button",{className:"details-btn",onClick:()=>window.location.href=`/events/${n.id}`,children:"Подробнее"})})]},n.id)})})}const H=()=>{const[c,r]=s.useState([]),[l,n]=s.useState(!0),[i,o]=s.useState(null),[d,j]=s.useState(""),u=async(h="")=>{const p=h?`/api/ref/events/sort?${h}`:"/api/ref/events";try{const x=await fetch(p);if(!x.ok)throw new Error("Ошибка при загрузке данных");const f=await x.json();r(f)}catch(x){o(x.message)}finally{n(!1)}};return s.useEffect(()=>{u(d)},[d]),e.jsxs(e.Fragment,{children:[e.jsx(U,{onFilter:h=>j(h)}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"№ темы"}),e.jsx("th",{children:"Наименование"}),e.jsx("th",{children:"Описание"}),e.jsx("th",{children:"Дата"}),e.jsx("th",{children:"Количество участников"}),e.jsx("th",{children:"Ссылки"}),e.jsx("th",{children:"Управление"})]})}),e.jsx("tbody",{children:e.jsx(_,{data:c,error:i,loading:l})})]})]})};function J(){const[c,r]=s.useState(!1),l=()=>r(!c);return e.jsxs("div",{className:"App",children:[e.jsx(G,{isOpen:c,toggleSidebar:l}),e.jsx(H,{})]})}const K=document.getElementById("root"),V=$.createRoot(K);V.render(e.jsxs(q.StrictMode,{children:[e.jsx(J,{})," "]}));
