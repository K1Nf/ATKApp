import{r as s,j as e,c as j}from"./EventForm-chunk.js";import{t as i}from"./toastr.min-chunk.js";const y=()=>{const[n,d]=s.useState(""),[o,h]=s.useState(""),[m,p]=s.useState([]),[c,g]=s.useState(!0),[l,f]=s.useState(null);if(s.useEffect(()=>{(async()=>{const r="/api/ref/auth/organizations";try{const a=await fetch(r);if(!a.ok)throw new Error("Ошибка при загрузке данных");const u=await a.json();console.log("Полученные организации:",u),p(u)}catch(a){f(a.message)}finally{g(!1)}})()},[]),c)return c;if(l)return l;const x=async t=>{if(t.preventDefault(),!n||!o.trim()){i.error("Выберите организацию и введите пароль","Ошибка");return}if(o.length<4){i.error("Пароль должен содержать минимум 4 символа","Ошибка");return}console.log("Пользователь выбрал организацию: "+n),console.log("Пользователь ввел пароль: "+o);try{const r=await fetch("/api/ref/auth/authorize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({selectedOrganization:n,password:o})});if(!r.ok)throw new Error("Неверные данные для входа");const a=await r.text();alert(a),i.success("Успешный вход!","Добро пожаловать"),window.location.href="/events"}catch(r){i.error(r.message||"Ошибка входа","Ошибка")}};return e.jsx("div",{className:"login-page",children:e.jsxs("div",{className:"login-card",children:[e.jsx("div",{className:"login-image",children:e.jsxs("video",{autoPlay:!0,muted:!0,loop:!0,playsInline:!0,children:[e.jsx("source",{src:"/images/fon.mp4",type:"video/mp4"}),"Ваш браузер не поддерживает видео."]})}),e.jsxs("form",{className:"login-form",onSubmit:x,children:[e.jsx("h2",{children:"Авторизация"}),e.jsx("label",{htmlFor:"organization",children:"Организация"}),e.jsxs("select",{id:"organization",value:n,onChange:t=>d(t.target.value),children:[e.jsx("option",{value:"",children:"-- Выберите организацию --"}),m.map(t=>e.jsxs("option",{value:t,children:[" ",t]}))]}),e.jsx("input",{type:"password",placeholder:"Пароль",value:o,onChange:t=>h(t.target.value)}),e.jsx("div",{className:"actions",children:e.jsx("button",{type:"submit",className:"primary-btn",children:"Войти"})})]})]})})};j.createRoot(document.getElementById("root")).render(e.jsx(s.StrictMode,{children:e.jsx(y,{})}));
